<script
  src="https://maps.googleapis.com/maps/api/js?language=ja&region=JP&key=AIzaSyCi_3RzETS7tHokVtKrb2wpoHC7ovon2IE&callback=initMap"
  async defer>
</script>
<script>
  function initMap() {
    "use strict";

  var target = document.getElementById("target");
  var geocoder = new google.maps.Geocoder();

  geocoder.geocode(
    {
      address: document.getElementById("address").innerHTML
    },
    function (results, status) {
      if (status !== "OK") {
        alert("マップの取得に失敗しました。: " + status);
        document.getElementById('target').innerText ="地図情報が取得できません。";
        return;
      }
      // results[0].geometry.locationに緯度経度の情報が入ってくる
      if (results[0]) {
        let location = results[0].geometry.location;
        let restaurantmap = new google.maps.Map(target, {
          center: location,
          zoom: 17,
        });
        // 緯度経度の情報をハッシュに変換
        let lat = location.lat();
        let lng =  location.lng();
        let latlng = {lat: lat, lng: lng};
        var marker = new google.maps.Marker({
          position: latlng,
          map: restaurantmap,
          animation: google.maps.Animation.DROP,
          title: document.getElementById("restaurant_name").innerHTML
          });
        var infoWindow = new google.maps.InfoWindow({
          content: document.getElementById("restaurant_name").innerHTML
          });
          marker.addListener('click', function() {
            infoWindow.open(restaurantmap, marker);
          });

      } else {
        arert("マップが見つかりませんでした。");
        document.getElementById('target').innerText ="地図情報が取得できません。";
        return;
      }
    }
  );

  }
</script>